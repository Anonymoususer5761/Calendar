{% extends 'layout.html' %}

{% block style %}
    <link rel="stylesheet" href="{{ url_for('static', filename='dates.css') }}">
{% endblock %}

{% block main %}
    <p id="selected-date" class="h1 text-primary">{{ date }}</p>

    <div class="d-flex m-2">
        <a class="btn btn-sm btn-outline-tertiary rounded" role="button" data-bs-toggle="modal" {% if current_user.is_authenticated %} data-bs-target="#add-event-modal" {% else %} data-bs-target="#alert-modal"{% endif %}>
            Add Event
        </a>
    </div>
    {% if current_user.is_authenticated %}
        <div id="add-event-modal" class="modal fade" tabindex="-1" aria-label="add-event" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form class="p-3" action="" method="post">
                        <a class="btn btn-sm btn-tertiary btn-close" role="button" data-bs-dismiss="modal" aria-label="close"></a>
                        {{ add_event_form.hidden_tag() }}
                        <div>
                            {{ add_event_form.name.label(class="form-label") }}
                            {{ add_event_form.name(class="form-control", autocomplete="off") }}
                        </div>
                        <div>
                            {{ add_event_form.description.label(class="form-label") }}
                            {{ add_event_form.description(class="form-control", autocomplete="off") }}
                        </div>
                        <div>
                            {{ add_event_form.start_time.label(class="form-label") }}
                            {{ add_event_form.start_time(class="form-control", value=add_event_form.start_time.default) }}
                        </div>
                        <div>
                            {{ add_event_form.end_time.label(class="form-label") }}
                            {{ add_event_form.end_time(class="form-control",value=add_event_form.start_time.default) }}
                        </div>
                        <div>
                            {{ add_event_form.event_color.label(class="form-label") }}
                            {{ add_event_form.event_color(id="colorInput", class="form-control form-control-color", type="color", value="#99c1f1", title="Color") }}
                        </div>
                        <div class="m-3">
                            {{ add_event_form.submit(class="btn btn-tertiary") }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    {% else %}
        <div id="alert-modal" class="modal fade" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <p id="modal-title" class="h5 modal-title">Login Required</p>
                        <a class="btn btn-sm btn-tertiary btn-close" role="button" data-bs-dismiss="modal" aria-label="close"></a>
                    </div>
                    <a href="{{ url_for('login') }}" class="btn btn-sm btn-tertiary" role="button">Sign In</a>
                </div>
            </div>
        </div>
    {% endif %}

    <div class="container-sm my-5 ms-3 me-5">
        <div class="row justify-content-center">
            <div class="day-name text-center">{{ day_name }}</div>
        </div>
        <div class="row">
            <svg class="col-1 row ms-0 me-1 ps-2 pe-0 hours-row-svg" height="2600" width="100%">
                <text class="hours-label" x="25%" y="22">23:00</text>
                <text class="yesterday" x="25%" y="67">Yesterday</text>
                {% for i in range(25) %}
                    <text class="hours-label" x="25%" y="{{ i * 100 + 122 }}">{{ "{:02d}".format(i) }}:00</text>
                {% endfor %}
            </svg>
            <div id="day-timeline" class="col-10 p-0 ms-0 mt-3 pe-5">
                <svg class="hours-line-svg" height="2600" width="100%">
                    {% for i in range(1, 25) %}
                        <line class="hours-line" x1="0" y1="{{ i * 100 }}" x2="100%" y2="{{ i * 100}}"></line>
                    {% endfor %}
                    <line class="now-line" x1="0" y1="50" x2="100%" y2="50"></line>
                </svg>
            </div>
        </div>
    </div>

{% endblock main %}